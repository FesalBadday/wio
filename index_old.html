<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>ูู ุจุฑุง ุงูุณุงููุฉุ</title>
  <link rel="stylesheet" href="css/style.css">

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => { navigator.serviceWorker.register('sw.js'); });
    }
  </script>
</head>

<body>
  <div id="orientation-overlay">...</div>
  <div id="confetti-container"></div>
  <canvas id="matrix-bg" class="fixed top-0 left-0 w-full h-full z-[-1] opacity-20 pointer-events-none"></canvas>

  <div id="app" class="w-full flex justify-center items-center p-4">

    <div id="screen-start" class="glass-panel text-center">
      <div id="hero-emoji" class="mb-10 detective-float text-8xl sm:text-9xl text-center">๐ต๏ธโโ๏ธ</div>
      <h1
        class="text-4xl sm:text-6xl font-black mb-8 bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 via-purple-400 to-emerald-400 leading-normal">
        ูู ุจุฑุง ุงูุณุงููุฉุ
      </h1>

      <div class="space-y-4 text-center">
        <button onclick="setGameMode('local')"
          class="btn-gradient w-full py-5 rounded-3xl text-xl font-black shadow-lg">
          ๐ฑ ูุนุจ ูุญูู (ุฌูุงุฒ ูุงุญุฏ)
        </button>

        <button onclick="setGameMode('online')"
          class="w-full py-5 bg-emerald-600 hover:bg-emerald-500 text-white rounded-3xl text-xl font-black shadow-lg transition-all border border-emerald-400">
          ๐ ูุนุจ ุฃูููุงูู (ุนู ุจุนุฏ)
        </button>

        <div class="grid grid-cols-2 gap-4 text-center mt-4">
          <button onclick="showScreen('leaderboard')" class="btn-secondary-theme py-4 rounded-2xl font-bold">๐
            ุงูุตุฏุงุฑุฉ</button>
          <button onclick="showScreen('rules')" class="btn-secondary-theme py-4 rounded-2xl font-bold">๐
            ุงูููุงุนุฏ</button>
        </div>
      </div>
    </div>

    <div id="screen-lobby" class="glass-panel hidden text-center">
      <h2 class="text-3xl font-black mb-6 text-emerald-400">ุงูุฑุจุท ุงูุฃูููุงูู ๐</h2>

      <div id="lobby-step-1">
        <p class="text-theme-muted mb-4 font-bold">ุงุฎุชุฑ ุงุณูู ูุตูุฑุชู:</p>
        <input type="text" id="online-player-name"
          class="w-full bg-slate-800/50 border border-white/10 rounded-xl p-4 text-white text-center font-bold mb-4 focus:border-emerald-500 outline-none"
          placeholder="ุงุณูู ุงููุณุชุนุงุฑ...">

        <div class="flex justify-center gap-2 mb-6 overflow-x-auto pb-2" id="online-avatar-select">
        </div>

        <div class="grid grid-cols-2 gap-4">
          <button onclick="createOnlineRoom()"
            class="py-4 bg-indigo-600 rounded-2xl font-black text-white shadow-lg">ุฅูุดุงุก ุบุฑูุฉ ๐</button>
          <button onclick="showJoinInputs()"
            class="py-4 bg-slate-700 rounded-2xl font-black text-white shadow-lg">ุงูุถูุงู ๐โโ๏ธ</button>
        </div>
      </div>

      <div id="lobby-join-inputs" class="hidden">
        <p class="text-theme-muted mb-4 font-bold">ุฃุฏุฎู ููุฏ ุงูุบุฑูุฉ:</p>
        <div class="flex justify-center gap-2 mb-6" dir="ltr">
          <input type="number" id="room-code-input"
            class="w-full bg-slate-800 border border-white/20 rounded-2xl p-4 text-center text-3xl font-mono tracking-widest text-emerald-400 outline-none focus:border-emerald-500"
            placeholder="1234">
        </div>
        <button onclick="joinOnlineRoom()"
          class="w-full py-4 btn-gradient rounded-2xl font-black text-white">ุฏุฎูู</button>
        <button onclick="showScreen('lobby'); resetLobbyUI();"
          class="mt-4 text-sm text-theme-muted underline">ุชุฑุงุฌุน</button>
      </div>

      <div id="lobby-waiting" class="hidden">
        <div class="bg-emerald-500/10 border border-emerald-500/30 p-4 rounded-2xl mb-6">
          <p class="text-xs text-emerald-300 font-bold mb-1">ููุฏ ุงูุบุฑูุฉ</p>
          <p id="display-room-code" class="text-5xl font-mono font-black text-white tracking-widest select-all">----</p>
        </div>

        <p class="text-right text-sm font-bold text-theme-muted mb-2">ุงููุชูุงุฌุฏูู ุญุงููุงู:</p>
        <div id="lobby-players-list" class="grid grid-cols-2 gap-3 mb-8"></div>

        <div id="host-controls" class="hidden">
          <p class="text-xs text-indigo-300 mb-2">ุฃูุช ุงููุถูู (Host) ๐</p>
          <button onclick="showScreen('category-select')"
            class="w-full py-5 btn-gradient rounded-3xl font-black text-white animate-pulse">ุฅุนุฏุงุฏ ุงููุนุจุฉ ูุจุฏุก ุงูุฌููุฉ
            ๐</button>
        </div>
        <div id="guest-waiting-msg" class="hidden">
          <p class="text-indigo-300 font-bold animate-pulse">ูู ุงูุชุธุงุฑ ุงููุถูู ูุจุฏุก ุงููุนุจุฉ...</p>
        </div>
      </div>
    </div>

    <div id="screen-setup" class="glass-panel hidden text-right">
      <div id="local-setup-options">
      </div>
    </div>

  </div>

  <script src="js/data.js"></script>
  <script src="js/game.js"></script>
</body>

</html>